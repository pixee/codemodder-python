rules:
  - id: upgrade-sslcontext-tls
    message: Upgrade weak SSL/TLS protocol version in SSLContext
    severity: WARNING
    languages:
      - python
    patterns:
      - pattern-either:
        - pattern: ssl.SSLContext(...,ssl.PROTOCOL_SSLv2,...)
        - pattern: ssl.SSLContext(...,protocol=ssl.PROTOCOL_SSLv2,...)
        - pattern: ssl.SSLContext(...,ssl.PROTOCOL_SSLv3,...)
        - pattern: ssl.SSLContext(...,protocol=ssl.PROTOCOL_SSLv3,...)
        - pattern: ssl.SSLContext(...,ssl.PROTOCOL_TLSv1,...)
        - pattern: ssl.SSLContext(...,protocol=ssl.PROTOCOL_TLSv1,...)
        - pattern: ssl.SSLContext(...,ssl.PROTOCOL_TLSv1_1,...)
        - pattern: ssl.SSLContext(...,protocol=ssl.PROTOCOL_TLSv1_1,...)
        - pattern: ssl.SSLContext(...,ssl.PROTOCOL_TLS,...)
        - pattern: ssl.SSLContext(...,protocol=ssl.PROTOCOL_TLS,...)
      - pattern-inside: |
          import ssl
          ...
